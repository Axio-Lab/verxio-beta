<div align="center">
  
  **Grow your cashflow with prepaid loyalty cards**
  
  [![Verxio Protocol](https://img.shields.io/badge/Built%20with-Verxio%20Protocol-blue)](https://github.com/verxioprotocol)
  [![Solana](https://img.shields.io/badge/Blockchain-Solana-purple)](https://solana.com)
  [![Metaplex Core](https://img.shields.io/badge/Powered%20by-Metaplex%20Core-orange)](https://developers.metaplex.com/)

</div>

---

## Demo

> **Coming Soon**: Watch our demo video to see Verxio Checkout in action!

<!-- Add your demo video here when ready -->
<!-- [![Verxio Checkout Demo](video-thumbnail.png)](your-video-link) -->



---

## Overview

Verxio's loyalty-native checkout experience with comprehensive loyalty program management, voucher systems, and reward distribution built on top of **[Verxio Protocol](https://github.com/Axio-Lab/verxioprotocol)** - an open-source, permissionless loyalty infrastructure  powered by [Metaplex Core NFTs](https://developers.metaplex.com/core).

Verxio transforms real-world commerce by turning loyalty passes and vouchers into **Metaplex Core NFTs** that function as **autonomous wallets**. Unlike traditional loyalty programs, Verxio's loyalty assets can hold tokens, sign transactions, and make payments directly at checkout - enabling true prepaid loyalty cards that grow your business's cashflow.

### What is Verxio Protocol?

**Verxio Protocol** is the first open-source permissionless on-chain loyalty infrastructure that brings programmable loyalty to Web3 through **dynamic metadata programming** for real-world commerce. 

Built on top of Metaplex Core, Verxio provides:

- **NFT-Based Loyalty Passes**: Loyalty passes are Metaplex Core NFTs with embedded point systems and dynamic metadata that updates in real-time
- **Autonomous Wallet Technology**: Each loyalty asset serves as an autonomous wallet capable of holding SPL tokens and signing transactions
- **Payment-Enabled Loyalty Cards**: Holders can make payments directly with their loyalty NFTs at checkout, combining rewards with purchasing power
- **Dynamic Metadata Programming**: Loyalty data (points, tiers, rewards) updates on-chain using Metaplex Core's plugin system
- **Voucher NFTs**: Vouchers are also Metaplex Core NFTs with programmable redemption logic and token-backing capabilities
- **Tiered Rewards**: Multi-tier loyalty programs with customizable benefits and automatic tier progression

### The Power of Metaplex Core NFTs

Verxio leverages **Metaplex Core's plugin architecture** to create loyalty assets that are not just collectibles, but functional commerce tools:

- **Lifecycle Hooks**: Automatic point awards on transfers and purchases
- **External Plugins**: Store loyalty data (XP, tiers, voucher values) directly on-chain
- **Update Authority**: Merchants control and update loyalty rules programmatically
- **Token Holders**: Loyalty NFTs can hold and manage SPL tokens (USDC, custom tokens)
- **Transaction Signing**: NFTs can authorize payments and transfers autonomously

This enables **prepaid loyalty cards** where customers load value (USDC) onto their loyalty NFT and spend it while earning rewards - a true Web3 innovation for real-world commerce.

🔗 **Learn More**: [Documentation](https://docs.verxio.xyz)

---

## Key Features

### Loyalty Programs

Create and manage comprehensive loyalty programs with Verxio Protocol's permissionless infrastructure, powered by **Metaplex Core NFTs with dynamic metadata**:

#### Metaplex Core NFT Loyalty Passes

Each loyalty pass is a **Metaplex Core NFT** that serves as both a membership card and an **autonomous wallet**:

- **NFT-Based Passes**: Loyalty passes are Metaplex Core NFTs automatically issued to customers
- **Autonomous Wallet Capability**: Each loyalty NFT can hold SPL tokens (USDC, etc.) and sign transactions independently
- **Payment at Checkout**: Holders can pay directly with their loyalty NFT, using loaded tokens while earning points simultaneously
- **Dynamic Metadata**: Points, tiers, and rewards update in real-time on-chain using Metaplex Core's external plugins
- **Points & XP System**: Track customer engagement through on-chain point accumulation stored in NFT metadata
- **Multi-Tier Programs**: Configure bronze, silver, gold, and platinum tiers with automatic progression
- **Points Per Action**: Configure point rewards for purchases, referrals, and custom actions
- **Membership Management**: Track member progress, tier upgrades, and reward claims
- **Claim Pages**: Shareable links for customers to claim their loyalty NFT passes
- **Purchase Integration**: Automatically award loyalty points on checkout completion

#### The Prepaid Loyalty Card Model

**Revolutionary Commerce Model**: Customers can load tokens onto their loyalty NFT and use it as a prepaid card that:
- ✅ Holds customer funds (grows merchant cashflow upfront)
- ✅ Makes payments directly at checkout
- ✅ Earns loyalty points automatically on every transaction
- ✅ Unlocks tier-based benefits and discounts
- ✅ Remains under the customer's custody (non-custodial)

**How It Works:**
1. Merchant creates a loyalty program collection using Metaplex Core
2. Customer receives a loyalty pass NFT on first purchase or claim
3. Customer can load USDC/tokens onto their loyalty NFT (prepaid balance)
4. At checkout, the customer pays with their loyalty NFT (autonomous wallet signs the transaction)
5. Points are automatically awarded and metadata updates on-chain
6. Members progress through tiers based on accumulated XP
7. Benefits, discounts, and exclusive perks unlock at each tier level

### Loyalty Vouchers

Multi-type voucher system for flexible promotional campaigns, powered by **Metaplex Core NFTs** with programmable redemption logic:

#### Metaplex Core NFT Vouchers

Every voucher is a **Metaplex Core NFT** with dynamic metadata and programmable commerce capabilities:

- **NFT Infrastructure**: Vouchers are Metaplex Core NFTs with embedded value and redemption logic
- **Dynamic Metadata Programming**: Voucher data (value, expiry, uses) stored and updated on-chain
- **Autonomous Wallet**: Token vouchers function as autonomous wallets holding real asset value
- **On-chain Validation**: All voucher data and redemption rules enforced by Metaplex Core plugins

#### Voucher Types:
- **PERCENTAGE_OFF**: Percentage-based discounts (e.g., 10% off) stored in NFT metadata
- **FIXED_VERXIO_CREDITS**: Fixed Verxio credit amounts embedded in the NFT
- **FREE_ITEM**: Free product vouchers with programmable redemption conditions
- **TOKEN**: SPL token-backed vouchers (USDC, custom tokens) - NFT holds actual tokens

#### Features:
- **Expiry Management**: Set custom expiration dates enforced on-chain
- **Max Uses**: Configure single-use or multi-use vouchers with on-chain tracking
- **Transferability**: Control whether vouchers can be transferred (Metaplex Core feature)
- **Merchant Control**: Redeem, cancel, or extend voucher validity via update authority
- **Conditions**: Add custom redemption conditions stored in NFT metadata
- **Real Asset Backing**: Token vouchers hold actual SPL tokens within the NFT

### Reward Claim System

Shareable reward links for distributing vouchers and incentives:

- **Reward Links**: Generate unique shareable URLs for reward distribution
- **One-Click Claims**: Users claim rewards through simple authentication
- **Multi-Format Support**: Support for all voucher types and tokens
- **Escrow System**: Secure token transfers through an escrow mechanism
- **Token Withdrawal**: Recipients can withdraw tokens from claimed vouchers
- **Status Tracking**: Monitor claimed vs. unclaimed rewards
- **QR Code Integration**: Generate QR codes for offline distribution

**Use Cases:**
- Marketing campaigns and promotions
- Customer appreciation rewards
- Referral program incentives
- Event-based giveaways
- Loyalty program tier rewards

### Token Vouchers

Advanced token-backed voucher system with real asset backing, leveraging **Metaplex Core NFTs as autonomous wallets**:

#### NFT-Based Asset Wallets

Token vouchers are **Metaplex Core NFTs that function as autonomous wallets**, capable of holding and managing real SPL tokens:

- **Autonomous Wallet Technology**: Each voucher NFT is an independent wallet that can hold tokens
- **Real Asset Backing**: Voucher NFTs hold actual SPL tokens (USDC, BONK, custom tokens) within their account
- **Transaction Signing**: Vouchers can sign and authorize token transfers autonomously
- **SPL Token Support**: Works with any Solana SPL token standard
- **On-chain Token Management**: Token balance and metadata stored directly on the NFT

#### Features:
- **Escrow Integration**: Secure token transfers to escrow or directly to voucher NFT addresses
- **Balance Tracking**: Real-time token balance for each voucher NFT queried on-chain
- **Partial Redemption**: Redeem portions of voucher value while maintaining the remaining balance
- **Withdrawal System**: Transfer voucher tokens to external wallets via NFT signing authority
- **Token Transfer Records**: Complete audit trail of all token movements to/from voucher NFTs
- **Dynamic Metadata**: Token balance and voucher worth update in NFT metadata automatically
- **Payment Capability**: Use token vouchers directly for payments at Verxio Checkout

**Real-World Use Case**: A merchant issues a 50 USDC voucher NFT to a customer. The NFT itself holds the 50 USDC tokens. The customer can redeem portions (e.g., 10 USDC at a time) or use the entire voucher for payment, all while the NFT autonomously manages the token transfers.

### Payment & Checkout

Seamless Solana-based payment infrastructure with **Metaplex Core NFT payment capabilities**:

#### Pay with Loyalty NFTs

Revolutionary checkout experience where customers can pay directly using their **loyalty NFT as an autonomous wallet**:

- **NFT-Powered Payments**: Customers can pay using tokens held in their loyalty pass NFT
- **Autonomous Transaction Signing**: Loyalty NFTs sign payment transactions independently
- **Earn While You Spend**: Payments made with loyalty NFTs automatically earn points
- **Prepaid Balance Model**: Load tokens onto loyalty NFT and spend from prepaid balance
- **Seamless Integration**: Works with the standard Solana Pay protocol

#### Additional Features:
- **Solana Pay Integration**: Native Solana Pay protocol support
- **USDC Payments**: Stablecoin payments for predictable pricing
- **Fee Sponsorship**: Optional transaction fee sponsorship for better UX
- **Loyalty Discounts**: Automatic discount application for loyalty members and tier benefits
- **Multi-Voucher Payments**: Pay with voucher NFTs + wallet combination
- **QR Code Checkout**: Mobile-friendly QR code payment flow
- **Real-time Status**: Live payment status tracking and confirmations
- **Dynamic Metadata Updates**: Points and tier progress update on-chain after each payment

---

## Architecture

### Metaplex Core NFT Implementation

Verxio Checkout leverages **Metaplex Core's advanced NFT infrastructure** to create functional commerce assets:

#### Loyalty Passes as Autonomous Wallets

```
┌─────────────────────────────────────────────────────────┐
│         Metaplex Core NFT (Loyalty Pass)                │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  NFT Metadata (Dynamic)                        │    │
│  │  - Name: "Coffee Shop Gold Member"            │    │
│  │  - Points: 5,420 XP                            │    │
│  │  - Tier: Gold                                  │    │
│  │  - Benefits: 10% discount, early access        │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  External Plugin (Loyalty Data)                │    │
│  │  - current_tier: "gold"                        │    │
│  │  - xp: 5420                                    │    │
│  │  - rewards: [...]                              │    │
│  │  - last_updated: timestamp                     │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  Token Account (Autonomous Wallet)             │    │
│  │  - USDC Balance: 50.00                         │    │
│  │  - Can sign transactions                       │    │
│  │  - Can hold any SPL token                      │    │
│  │  - Can make payments                           │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  Update Authority: Merchant (can update points/tiers)   │
│  Owner: Customer (holds NFT in their wallet)            │
└─────────────────────────────────────────────────────────┘
```

#### How Autonomous Wallet Works

1. **Token Loading**: Customer transfers USDC to their loyalty NFT's token account
2. **Checkout Payment**: NFT authorizes transfer from its token account to the merchant
3. **Point Award**: Merchant updates NFT's external plugin data (add points)
4. **Metadata Update**: Dynamic metadata reflects new points and tier
5. **Tier Progression**: Automatic tier upgrade when thresholds are met

#### Voucher NFTs with Token Backing

```
┌─────────────────────────────────────────────────────────┐
│         Metaplex Core NFT (Token Voucher)               │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  NFT Metadata                                  │    │
│  │  - Name: "50 USDC Voucher"                     │    │
│  │  - Type: TOKEN                                 │    │
│  │  - Value: 50 USDC                              │    │
│  │  - Expiry: 2025-12-31                          │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  External Plugin (Voucher Data)                │    │
│  │  - type: "token"                               │    │
│  │  - value: 50                                   │    │
│  │  - max_uses: 1                                 │    │
│  │  - expiry_date: timestamp                      │    │
│  │  - token_address: USDC mint                    │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  ┌────────────────────────────────────────────────┐    │
│  │  Token Account (Holds Real USDC)               │    │
│  │  - USDC Balance: 50.00                         │    │
│  │  - Customer can withdraw to an external wallet    │    │
│  │  - Can be used for payment at checkout         │    │
│  └────────────────────────────────────────────────┘    │
│                                                          │
│  Owner: Customer (can redeem or transfer)               │
└─────────────────────────────────────────────────────────┘
```

Unlike traditional vouchers that are just database records, Verxio vouchers are actual on-chain assets that hold real value and can be used autonomously for commerce.

### Data Flow: Loyalty Program Purchase with NFT Payment

```
1. Customer Checkout
   ├─> Option A: Pay with a regular wallet
   └─> Option B: Pay with loyalty NFT (autonomous wallet)
   
2. Payment Transaction (If using Loyalty NFT)
   ├─> Customer selects "Pay with Loyalty Card"
   ├─> System fetches NFT's token account balance
   ├─> Loyalty NFT authorizes USDC transfer from its token account
   └─> Transaction signed by NFT's autonomous wallet
   
3. Payment Confirmed (On-chain)
   └─> Payment record updated to SUCCESS
   
4. Check Loyalty Membership
   ├─> If Member (has loyalty NFT):
   │   ├─> Fetch existing Metaplex Core NFT loyalty pass
   │   ├─> Award points via Verxio Protocol (updates external plugin)
   │   ├─> Update NFT's dynamic metadata (points, tier)
   │   ├─> Check tier threshold and upgrade if needed
   │   └─> Deduct Verxio credits from the merchant
   │
   └─> If Not Member:
       ├─> Issue new Metaplex Core NFT loyalty pass (500 credits)
       ├─> Mint NFT with initial metadata and external plugin
       ├─> Award initial points (stored in NFT's external plugin)
       ├─> Set up autonomous wallet capability
       ├─> Check for tier upgrade
       └─> Save pass to database
       
5. Dynamic Metadata Update (On-chain)
   ├─> Update external plugin data: { xp: new_value, tier: current_tier }
   ├─> Update NFT metadata: points, tier name, benefits
   └─> Emit events for tier progression
   
6. User Receives Updated NFT
   └─> Wallet displays updated points, tier, and benefits in real-time
```

### Data Flow: Token Voucher Creation (Metaplex Core NFT)

```
1. Merchant Creates Token Voucher
   ├─> Specify token address (e.g., USDC mint)
   ├─> Set voucher value (e.g., 10 USDC)
   └─> Configure expiry, max uses, transferability
   
2. Verxio Credits Check
   └─> Requires 3,000 credits minimum
   
3. Token Balance Verification
   ├─> Check merchant's SPL token balance
   └─> Must have sufficient tokens for voucher value
   
4. Metaplex Core NFT Minting (Verxio Protocol)
   ├─> Create Metaplex Core NFT voucher asset
   ├─> Set NFT metadata: name, type, value, expiry
   ├─> Add external plugin with voucher data:
   │   └─> { type: "token", value: 10, token_address: USDC, max_uses: 1 }
   ├─> Set up an autonomous wallet for NFT
   └─> Mint NFT to the recipient address
   
5. Token Transfer to NFT Wallet
   ├─> Create associated token account for voucher NFT
   ├─> Transfer 10 USDC from the merchant to NFT's token account
   ├─> NFT now holds real USDC in its autonomous wallet
   └─> Record transfer in TokenTransferRecord
   
6. Credit Deduction
   ├─> Deduct 1,000 credits upfront
   └─> Deduct 2,000 credits on successful mint (total: 3,000)
   
7. Database Recording
   ├─> Save voucher NFT details (address, metadata URI)
   ├─> Record token transfer to NFT wallet
   └─> Link voucher NFT to merchant's collection
   
8. Customer Receives
   └─> Metaplex Core NFT voucher with 10 USDC in its autonomous wallet
       (can withdraw, redeem, or use for payment)
```

### Data Flow: Reward Claim (Metaplex Core NFT Minting)

```
1. User Accesses Reward Link
   └─> /reward/[slug]
   
2. Authentication (Privy)
   ├─> Email login + embedded wallet creation
   └─> User receives Solana wallet address
   
3. Claim Validation
   ├─> Check if already claimed
   ├─> Verify expiry date
   ├─> Check reward link status
   └─> Validate max uses
   
4. Metaplex Core NFT Voucher Minting
   ├─> If TOKEN voucher:
   │   ├─> Create Metaplex Core NFT with token metadata
   │   ├─> Add external plugin: { type: "token", value, token_address }
   │   ├─> Mint NFT to the user's wallet
   │   ├─> Create NFTs' associated token account
   │   ├─> Transfer tokens from escrow to NFT's autonomous wallet
   │   └─> NFT now holds real tokens (e.g., 10 USDC)
   │
   ├─> If PERCENTAGE_OFF voucher:
   │   ├─> Create Metaplex Core NFT
   │   ├─> Add external plugin: { type: "percentage_off", value: 25 }
   │   └─> Mint NFT with discount data embedded
   │
   └─> If FIXED_VERXIO_CREDITS:
       ├─> Create Metaplex Core NFT
       ├─> Add external plugin: { type: "fixed_credits", value: 500 }
       └─> Mint NFT with credit data
       
5. Dynamic Metadata Setup
   ├─> Generate metadata JSON with voucher details
   ├─> Upload to IPFS (Pinata)
   ├─> Set metadata URI on NFT
   └─> Configure external plugin for dynamic updates
   
6. Update Records
   ├─> Mark reward link as claimed
   ├─> Store voucher NFT address (Metaplex Core asset ID)
   ├─> Record token transfer (if TOKEN voucher)
   └─> Record timestamp and claimer address
   
7. User Receives Metaplex Core NFT
   ├─> NFT appears in wallet (supports Metaplex standards)
   ├─> Displays voucher value, expiry, and redemption status
   ├─> If token voucher: can withdraw tokens from the NFT's wallet
   └─> Can use NFT for payment at Verxio Checkout
```

---

## Getting Started

### Prerequisites

- Node.js 18+ and npm
- PostgreSQL database
- Solana wallet with devnet/mainnet SOL
- Helius API key (for RPC access)
- Privy account (for authentication)
- Pinata account (for IPFS storage)

### Installation

1. **Clone the repository**
```bash
git clone https://github.com/verxioprotocol/checkout.git
cd checkout
```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up environment variables**

   Create a `.env.local` file in the root directory:

   ```check env.example for variables```

4. **Set up the database**
```bash
# Generate Prisma client
npx prisma generate

# Run migrations
npx prisma migrate deploy

# (Optional) Push schema changes
npm run db:push
```

5. **Run the development server**
   ```bash
   npm run dev
   ```

6. **Open your browser**

   Navigate to [http://localhost:3000](http://localhost:3000)

---

<div align="center">
  
  **Built with ❤️ by the Verxio Team**
  
  [Website](https://www.verxio.xyz) • [GitHub](https://github.com/Axio-Lab/verxio-beta) • [Twitter](https://twitter.com/verxioprotocol)

</div>
